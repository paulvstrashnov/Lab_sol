# Предсказание растворимости молекул с помощью машинного обучения

## Цель
Разработать систему машинного обучения для предсказания растворимости молекул на основе их структуры, представленной в формате SMILES.

Необходимо реализовать полный pipeline обработки молекулярных данных, от парсинга SMILES до обучения и оценки моделей машинного обучения.

## Описание задачи
В фармацевтической индустрии и разработке новых материалов растворимость является одним из важнейших свойств молекул. Набор данных ESOL (a.k.a Delaney) содержит SMILES-представления молекул и значения их экспериментально измеренной растворимости.  Задача — разработать метод для точного предсказания растворимости на основе структуры молекулы.

## Этапы работы

### 1. Реализация парсера SMILES
Базовый парсер умеет обрабатывать только линейные молекулы с одинарными связями. Вам нужно расширить функциональность парсера для обработки более сложных SMILES-строк:
- Добавить поддержку ветвлений, циклических структур и различных типов связей
- Корректно обрабатывать ароматические атомы и связи

### 2. Feature engineering 
Это ключевая часть задания. Вам необходимо:
- Реализовать минимум 5 различных атомарных признаков, являющихся графовыми инвариантами. Примерами могут служить атомный номер (тип атома), число связей с соседними атомами (степень вершины графа), и т.д.
- Разработать не менее 3 методов агрегации признаков для соседних атомов
- Создать итеративные обновления признаков (подобно алгоритму Моргана)
- По желанию: разработать глобальные признаки на уровне всей молекулы

### 3. Обучение моделей
- Разделить набор данных ESOL на тренировочную, валидационную и тестовую выборки. Для максимально корректного разделения, можно использовать признаки, посчитанные для молекул (из датасета и/или самостоятельно).
- Использовать предоставленную структуру однослойной нейронной сети для регрессионной задачи как бейзлайн.
- Обучить модели с различными комбинациями признаков
- Оценить модели с использованием метрик RMSE и R² для регрессионной задачи и accuracy, macro f1 score и quadratic weighted kappa для задачи классификации.

### 4. Анализ результатов
- Определить, какие признаки вносят наибольший вклад в предсказание растворимости
- Объяснить полученные результаты с точки зрения химических свойств
- Сравнить производительность различных наборов признаков
- Обсудить ограничения и возможные улучшения модели

## Требования к результатам
- Код, реализующий парсер SMILES, извлечение признаков, модель МО и тесты к ним.
- Краткий отчет (1-3 страницы), описывающий ваш подход, протестированные признаки и анализ результатов
- Таблица в отчёте, сравнивающая эффективность различных наборов признаков
- Графики обучения сетей

## Важные замечания
- Фокус данной работы — на разработке эффективных признаков на основе графового представления молекул по аналогии с алгоритмом Моргана
- Не требуется усложнять архитектуру нейронной сети
- Поощряется экспериментирование с различными комбинациями признаков и методами их агрегации
- Глубина анализа и обоснование выбора признаков — важная часть оценки работы



Базовый функционал:

`python main.py --data_path "./data/test.csv" --epochs 2 --feature_methods basic`